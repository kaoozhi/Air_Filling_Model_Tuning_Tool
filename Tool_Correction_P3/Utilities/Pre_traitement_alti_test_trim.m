close all
clear
% data_list = 'ExportPCMAP_07-05-2021_HR12_BAL11_MC502_65A_0m_20C_ISO_NTQI_EGR_OFF1_filterd';
data_list = 'ExportPCMAP_31-05-2021_HR12_BAL11_MC502_65A_2500m_20C_ISO_NTQI_EGR_off_valid_filtered';
Data = load([data_list '.mat']);
% slicing_idx = {[1039 1063],[2172 2200], [3085 3136], [3971 4051], [4897 4939], [5786 5836], [6688 7020], [7718 7900], [8614 8689], [9535 9591], [10441 10480], [11351 11388], [12255 12290], [13150 13205], [14056 14104], [14981 15043], [15924 15979], [16772 16978], [17648 17869]}; %0m
% slicing_idx = {[792 947],[4499,4537],[4862, 4898],[5254, 5275],[5487, 5499],[5651, 5684]};%1000m
% slicing_idx = {[465 605],[2804,2840],[3086, 3143],[3388, 3409],[3638,3700],[4084,4089]}; %1500m
% slicing_idx = {[784 951],[5561,5615],[6334, 6457],[7130, 7250],[7908,8011],[8684,8791],[9464,9585],[10160,10355],[10671,10762]}; %2000m
% slicing_idx = {[1574 1747],[2359,2443],[7855, 7917],[8643, 8746],[9435,9544],[10210,10330],[10990,11120],[11780,11910],[12560,12670],[13300,13450],[13960,14131]}; %2500m
slicing_idx = {[1,101],	[937,1098],	[1975,2301],	[2860,3117],	[3760,3920],	[4647,4750],	[5540,5558],	[6432,6465],	[7317,7348],	[8253,8321],	[9146,9299],	[10042,10211],	[10941,11103],	[11832,11999]...
    ,	[12700,12869],	[13594,13807],	[14521,14801],	[15417,15691],	[16316,16621]}; % 2500m valid
varnames = fieldnames(Data);
Data_all_var = [];
for i=1:length(varnames)
    
    Data_all_var=[Data_all_var,Data.(varnames{i})];
    
end
idx = true(size(Data_all_var,1),1);
for j=1:length(slicing_idx)
    
    idx(slicing_idx{j}(1):slicing_idx{j}(2))=false;
end

Data_all_new = Data_all_var(idx,:);
for k=1:length(varnames )
    Data_all.(varnames{k})=Data_all_new(:,k);
end
save([data_list '_extracted.mat'],'-struct','Data_all')